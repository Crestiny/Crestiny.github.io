<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.0.2">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Crestiny&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/7/index.html">
<meta property="og:site_name" content="Crestiny&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="CrestinyCoco">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>Crestiny's Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Crestiny's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Life is fantastic ! </p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/18/Common-Web-Vulnerabilities-Causes-Damage-and-Defense/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/18/Common-Web-Vulnerabilities-Causes-Damage-and-Defense/" class="post-title-link" itemprop="url">Common Web Vulnerabilities: Causes, Damage and Defense</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-18 18:17:49" itemprop="dateCreated datePublished" datetime="2020-09-18T18:17:49+08:00">2020-09-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-28 02:13:13" itemprop="dateModified" datetime="2020-12-28T02:13:13+08:00">2020-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Web-Security/" itemprop="url" rel="index"><span itemprop="name">Web Security</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="注入Injection"><a class="header-anchor" href="#注入Injection">¶</a>注入Injection</h2>
<p>Injection flaws, such as <strong>SQL</strong>, <strong>NoSQL</strong>, <strong>OS</strong>, and <strong>LDAP</strong> injection, occur when untrusted data is sent to an interpreter as part of a command or query. The attacker’s hostile(怀有敌意的) data can trick the interpreter into <strong>executing unintended commands</strong> or <strong>accessing data without proper authorization</strong>.</p>
<h3 id="Causes"><a class="header-anchor" href="#Causes">¶</a>Causes</h3>
<p>刚刚讲过当我们访问动态网页时, Web 服务器会向数据访问层发起 Sql 查询请求，如果权限验证通过就会执行 Sql 语句。<br>
这种网站<strong>内部直接发送的Sql请求一般不会有危险</strong>，但实际情况是很多时候需要<strong>结合用户的输入数据动态构造 Sql 语句</strong>，如果用户输入的数据被构造成恶意 Sql 代码，Web 应用又未对动态构造的 Sql 语句使用的参数进行审查，则会带来意想不到的危险。<br>
程序开发过程中不注意规范书写sql语句和对特殊字符进行过滤，导致客户端可以通过全局变量POST和GET提交一些sql语句正常执行。</p>
<p>具体可阐述如下：</p>
<ol>
<li>WEB开发人员无法保证所有的输入都已经过滤</li>
<li>攻击者利用发送给SQL服务器的输入参数构造可执行的SQL代码（可加入到get请求、post请求、http头信息、cookie中）</li>
<li>数据库未做相应的安全配置</li>
</ol>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">个人总结：</span><br><span class="line">网页需要根据用户输入动态构造SQL语句的时候，如果过滤之类的安全工作没做好，就会导致恶意代码执行、绕过认证、数据泄露等危害。</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Damage"><a class="header-anchor" href="#Damage">¶</a>Damage</h3>
<ul>
<li>数据库信息泄漏：数据库中存放的用户的隐私信息的泄露。猜解后台数据库，这是利用最多的方式，盗取网站的敏感信息。</li>
<li>绕过认证，列如绕过验证登录网站后台。</li>
<li>注入可以借助数据库的存储过程进行提权等操作</li>
<li>网页篡改：通过操作数据库对特定网页进行篡改。</li>
<li>网站被挂马，传播恶意软件：修改数据库一些字段的值，嵌入网马链接，进行挂马攻击。</li>
<li>数据库被恶意操作：数据库服务器被攻击，数据库的系统管理员帐户被窜改。</li>
<li>服务器被远程控制，被安装后门。经由数据库服务器提供的操作系统支持，让黑客得以修改或控制操作系统。</li>
<li>破坏硬盘数据，瘫痪全系统。</li>
</ul>
<h3 id="Defense"><a class="header-anchor" href="#Defense">¶</a>Defense</h3>
<p>是开发人员应该思考的问题，作为测试人员，了解如何预防SQL注入，可以在发现注入攻击bug时，对bug产生原因进行定位。</p>
<ol>
<li>
<p>严格检查输入变量的类型和格式<br>
对于整数参数，加判断条件：不能为空、参数类型必须为数字<br>
对于字符串参数，可以使用正则表达式进行过滤：如：必须为[0-9a-zA-Z]范围内的字符串</p>
</li>
<li>
<p>过滤和转义特殊字符<br>
例如：引号、双引号、斜杠、反斜杠、冒号、 空字符等的字符<br>
过滤的对象: 用户的输入 | 提交的URL请求中的参数部分 | 从cookie中得到的数据<br>
在username这个变量前进行转义，对’、"、\等特殊字符进行转义，如：php中的addslashes()函数对username参数进行转义</p>
</li>
<li>
<p>利用mysql的预编译机制<br>
把sql语句的模板（变量采用占位符进行占位）发送给mysql服务器，mysql服务器对sql语句的模板进行编译，编译之后根据语句的优化分析对相应的索引进行优化，在最终绑定参数时把相应的参数传送给mysql服务器，直接进行执行，节省了sql查询时间，以及mysql服务器的资源，达到一次编译、多次执行的目的，除此之外，还可以防止SQL注入。具体是怎样防止SQL注入的呢？实际上当将绑定的参数传到mysql服务器，mysql服务器对参数进行编译，即填充到相应的占位符的过程中，做了转义操作。</p>
</li>
<li>
<p>监测方面目前大多都是日志监控+WAF（统一的filter）,部署防SQL注入系统或脚本</p>
</li>
<li>
<p>数据库日志容易解析,语法出错的、语法读Info表的建立黑白名单机制</p>
</li>
</ol>
<h3 id="References"><a class="header-anchor" href="#References">¶</a>References</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/github_36032947/article/details/78442189?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522160042717419195162113454%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&amp;request_id=160042717419195162113454&amp;biz_id=0&amp;utm_medium=distribute.pc_search_result.none-task-blog-2~blog~first_rank_v2~rank_blog_v1-1-78442189.pc_v2_rank_blog_v1&amp;utm_term=SQL%E6%B3%A8%E5%85%A5&amp;spm=1018.2118.3001.4187">SQL注入攻击常见方式及测试方法</a><br>
<a href=""></a></p>
<h2 id="失效的身份认证Broken-Authentication"><a class="header-anchor" href="#失效的身份认证Broken-Authentication">¶</a>失效的身份认证Broken Authentication</h2>
<p>Application functions related to authentication and session management are often implemented incorrectly, allowing attackers to compromise passwords, keys, or session tokens, or to exploit other implementation flaws to assume(篡夺) other users’ identities temporarily or permanently.</p>
<h3 id="前言：名词解释"><a class="header-anchor" href="#前言：名词解释">¶</a>前言：名词解释</h3>
<p>Web应用程序使用的HTTP协议是一种<strong>无连接</strong>，<strong>无状态</strong>协议。</p>
<p>无连接是指限制每次连接只处理一个请求，服务器处理完成客户的请求，收到客户的应答之后，即断开连接，可以节省传输时间</p>
<p>无状态是指对于事物处理没有记忆功能，服务器不知道客户端是什么状态。即用户给服务器发送HTTP请求之后，服务器根据请求，将数据发送给用户，但是发送完成之后，不会记录任何信息。</p>
<p>也就是说，服务器无法保留连接到网站的每个客户端（用户）的身份/活动的内存。那么试想，每次我们登录一个网站，如果意外关闭了，就得重新登录，使用起来会非常不便。<strong>Cookie和Session因此诞生，解决无记录状态的问题</strong>。</p>
<h4 id="Session"><a class="header-anchor" href="#Session">¶</a>Session</h4>
<p>Session负责在<strong>服务器端</strong>记录用户信息，在一个用户完成身份认证之后，存储所需要的用户资料，用于持久保存网站的活动。<strong>服务器使用唯一的会话令牌产生对应的会话ID</strong></p>
<h4 id="Cookie"><a class="header-anchor" href="#Cookie">¶</a>Cookie</h4>
<p>Cookie由服务器发送并存储在<strong>客户端</strong>，在用户访问网站的时候创建，<strong>用以跟踪用户在网站中的活动</strong>，每次请求客户端都需要把它发送给服务器。当用户意外中断后，由于Cookie的存在就可以从中断的地方继续。</p>
<h4 id="身份认证"><a class="header-anchor" href="#身份认证">¶</a>身份认证</h4>
<p>身份认证最常用于系统登录，形式一般为<strong>用户名和密码登录</strong>方式，在安全性要求较高的情况下，还有验证码、客户端证书、Ukey等</p>
<h4 id="会话管理"><a class="header-anchor" href="#会话管理">¶</a>会话管理</h4>
<p><strong>HTTP利用会话机制来实现身份认证</strong>，HTTP身份认证的结果往往是<strong>获得一个令牌并放在cookie中，之后的身份识别只需读授权令牌，而无需再次进行登录认证</strong></p>
<h3 id="Causes-v2"><a class="header-anchor" href="#Causes-v2">¶</a>Causes</h3>
<ul>
<li>用户身份验证凭据在存储时不受保护</li>
<li>登录凭证可以被猜测或重写</li>
<li>会话ID直接暴露在URL中</li>
<li>会话ID容易收到会话固定攻击</li>
<li>会话ID不会超时失效，或者用户会话或身份验证令牌在注销时未失效</li>
<li>会话ID在登录成功之后不会轮换</li>
<li>密码，会话ID或者其他的登录凭据未经过加密传输</li>
</ul>
<h3 id="Attack"><a class="header-anchor" href="#Attack">¶</a>Attack</h3>
<ul>
<li>
<p>弱口令：弱口令的危害不言而喻，通常指的是仅包含简单的数字和字母组合的口令</p>
</li>
<li>
<p>口令破解：掌握了口令的组合方式或是加密细节</p>
</li>
<li>
<p>Cookie窃取&amp;伪造&amp;绕过：因为Cookie是存储在客户端的，相对而言容易被攻击者窃取</p>
</li>
<li>
<p>越权访问：分为垂直越权访问和水平越权访问，垂直越前访问是指不同用户级别之间的越权，比如普通用户能够执行管理员用户的权限。水平越权即同一级别用户之间的越权操作</p>
</li>
<li>
<p>会话固定：一种诱骗受害者使用攻击者拟定的Session ID的攻击手段，通过让合法用户使用攻击者设置的Session ID进行登录，使得web应用不在生成新的Session ID</p>
</li>
<li>
<p>会话劫持：就是在一次正常的通信过程中，攻击者作为第三方参与到其中，或者是在数据里加入其他信息，甚至将双方的通信模式暗中改变，即从直接联系变成有攻击者参与的联系。简单的说，就是攻击者把自己插入到受害者和目标机器之间，并设法让受害者和目标机器之间的数据通道变为受害者和目标机器之间存在一个看起来像“中转站”的代理机器（攻击者的机器）的数据通道，从而干涉两台机器之间的数据传输，例如监听敏感数据、替换数据等。由于攻击者已经介入其中，他能轻易知道双方传输的数据内容，还能根据自己的意愿去左右它。这个“中转站”可以是逻辑上的，也可以是物理上的，关键在于它能否获取到通信双方的数据。</p>
</li>
</ul>
<h3 id="Damage-v2"><a class="header-anchor" href="#Damage-v2">¶</a>Damage</h3>
<ul>
<li>窃取用户凭证和会话信息</li>
<li>恶意用户冒充用户身份查看或者变更记录，甚至执行事务</li>
<li>访问未授权的页面和资源</li>
<li>执行超越权限操作</li>
</ul>
<h3 id="Defense-v2"><a class="header-anchor" href="#Defense-v2">¶</a>Defense</h3>
<ul>
<li>在可能的情况下，实现多因素身份验证，以防止自动、凭证填充、暴力破解和被盗凭据再利用攻击。</li>
<li>不要使用发送或部署默认的凭证，特别是管理员用户。</li>
<li>执行弱密码检查，例如测试新或变更的密码，以纠正“排名前10000个弱密码” 列表。</li>
<li>将密码长度、复杂性和循环策略与NIST-800-63 B的指导方针的5.1.1章节-记住秘密，或其他现代的基于证据的密码策略相一致。</li>
<li>确认注册、凭据恢复和API路径，通过对所有输出结果使用相同的消息，用以抵御账户枚举攻击。</li>
<li>限制或逐渐延迟失败的登录尝试。记录所有失败信息并在凭据填充、暴力破解或其他攻击被检测时提醒管理员。</li>
<li>使用服务器端安全的内置会话管理器，在登录后生成高度复杂的新随机会话ID。会话ID不能在URL中，可以安全地存储和当登出、闲置、绝对超时后使其失效。</li>
</ul>
<h3 id="References-v2"><a class="header-anchor" href="#References-v2">¶</a>References</h3>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/CH42e/p/13162177.html">A2 失效的身份认证和会话管理</a></p>
<h2 id="敏感数据泄露Sensitive-Data-Exposure"><a class="header-anchor" href="#敏感数据泄露Sensitive-Data-Exposure">¶</a>敏感数据泄露Sensitive Data Exposure</h2>
<p>Many web applications and APIs do not properly protect sensitive data, such as financial, healthcare, and PII. Attackers may steal or modify such weakly protected data to conduct credit card fraud, identity theft, or other crimes. Sensitive data may be compromised without extra protection, such as encryption at rest or in transit, and requires special precautions when exchanged with the browser.</p>
<h3 id="Causes-v3"><a class="header-anchor" href="#Causes-v3">¶</a>Causes</h3>
<p>对敏感数据的弱保护，具体原因如：</p>
<ul>
<li>错误的云存储配置</li>
<li>未受保护的代码存储库</li>
<li>易受攻击的开源软件</li>
</ul>
<h3 id="Damage-v3"><a class="header-anchor" href="#Damage-v3">¶</a>Damage</h3>
<p>利用敏感信息可以：</p>
<ul>
<li>信用卡欺诈</li>
<li>身份偷窃</li>
<li>等等</li>
</ul>
<h3 id="Defense-v3"><a class="header-anchor" href="#Defense-v3">¶</a>Defense</h3>
<p>对一些需要加密的敏感数据，应该起码做到以下几点：</p>
<ul>
<li>对系统处理、存储或传输的数据分类，并根据分类进行访问控制。</li>
<li>熟悉与敏感数据保护相关的法律和条例，并根据每项法规要求保护敏感数据。</li>
<li>对于没必要存放的、重要的敏感数据，应当尽快清除，或者通过PCI DSS标记或拦截。未存储的数据不能被窃取。</li>
<li>确保存储的所有敏感数据被加密。</li>
<li>确保使用了最新的、强大的标准算法或密码、参数、协议和密匙，并且密钥管理到位。</li>
<li>确保传输过程中的数据被加密，如：使用TLS。确保数据加密被强制执行，如：使用HTTP严格安全传输协议（HSTS ）。</li>
<li>禁止缓存对包含敏感数据的响应。</li>
<li>确保使用密码专用算法存储密码，如：Argon2 、 scrypt 、bcrypt 或者PBKDF2 。将工作因素（延迟因素）设置在可接受范围。</li>
<li>单独验证每个安全配置项的有效性。</li>
</ul>
<h2 id="XML外部实体-XML-External-Entities-XXE"><a class="header-anchor" href="#XML外部实体-XML-External-Entities-XXE">¶</a>XML外部实体 XML External Entities (XXE)</h2>
<p>Many older or poorly configured XML processors evaluate external entity references within XML documents. External entities can be used to disclose internal files using the file URI handler, internal file shares, internal port scanning, remote code execution, and denial of service attacks.<br>
XML外部实体攻击是一种针对解析XML格式应用程序的攻击类型之一。此类攻击发生在当配置不当的XML解析器处理指向外部实体的文档时，可能会导致敏感文件泄露、拒绝服务攻击、服务器端请求伪造、端口扫描（解析器所在域）和其他系统影响。</p>
<h3 id="What-is-XML？"><a class="header-anchor" href="#What-is-XML？">¶</a>What is XML？</h3>
<p>XML由3个部分构成，它们分别是：文档类型定义（Document Type Definition，DTD），即XML的布局语言；可扩展的样式语言（Extensible Style Language，XSL），即XML的样式表语言；以及可扩展链接语言（Extensible Link Language，XLL）。</p>
<p>XML:可扩展标记语言，标准通用标记语言的子集，是一种用于标记电子文件使其具有结构性的标记语言。它被设计用来传输和存储数据(而不是储存数据),可扩展标记语言是一种很像超文本标记语言的标记语言。它的设计宗旨是传输数据，而不是显示数据。它的标签没有被预定义。您需要自行定义标签。它被设计为具有自我描述性。它是W3C的推荐标准。</p>
<p>可扩展标记语言(XML)和超文本标记语言(HTML)为不同的目的而设计</p>
<p>它被设计用来传输和存储数据，其<strong>焦点是数据的内容</strong>。</p>
<p>超文本标记语言被设计用来显示数据，其焦点是数据的外观</p>
<p>XML使用元素和属性来描述数据。在数据传送过程中，XML始终保留了诸如父/子关系这样的数据结构。几个应用程序 可以共享和解析同一个XML文件，不必使用传统的字符串解析或拆解过程。 相反，普通文件不对每个数据段做描述(除了在头文件中)，也不保留数据关系结构。使用XML做数据交换可以使应用程序更具有弹性，因为可以用位置(与普通文件一样)或用元素名(从数据库)来存取XML数据。</p>
<h3 id="XML的实体"><a class="header-anchor" href="#XML的实体">¶</a>XML的实体</h3>
<p>XML 中的实体分为以下五种：字符实体，命名实体，外部实体，参数实体，内部实体，普通实体和参数实体都分为内部实体和外部实体两种，外部实体定义需要加上** SYSTEM关键字**，其内容是URL所指向的外部文件实际的内容。如果不加SYSTEM关键字，则为内部实体，表示实体指代内容为字符串。</p>
<h3 id="Causes-v4"><a class="header-anchor" href="#Causes-v4">¶</a>Causes</h3>
<p>XXE注入，即XML External Entity，XML外部实体注入。通过 XML 实体，”SYSTEM”关键词导致 XML 解析器可以从本地文件或者远程 URI 中读取数据。所以攻击者可以通过 XML 实体传递自己构造的恶意值，是处理程序解析它。当引用外部实体时，通过构造恶意内容，可导致读取任意文件、执行系统命令、探测内网端口、攻击内网网站等危害。</p>
<p>既然XML可以从外部读取DTD文件，那我们就自然地想到了如果将路径换成另一个文件的路径，那么服务器在解析这个XML的时候就会把那个文件的内容赋值给SYSTEM前面的根元素中，只要我们在XML中让前面的根元素的内容显示出来，不就可以读取那个文件的内容了。这就造成了一个任意文件读取的漏洞。</p>
<p>那如果我们指向的是一个内网主机的端口呢？是否会给出错误信息，我们是不是可以从错误信息上来判断内网主机这个端口是否开放，这就造成了一个内部端口被探测的问题。另外，一般来说，服务器解析XML有两种方式，一种是一次性将整个XML加载进内存中，进行解析；另一种是一部分一部分的、“流式”地加载、解析。如果我们递归地调用XML定义，一次性调用巨量的定义，那么服务器的内存就会被消耗完，造成了拒绝服务攻击。</p>
<h3 id="Damage-v4"><a class="header-anchor" href="#Damage-v4">¶</a>Damage</h3>
<ul>
<li>
<p>检索文件，其中定义了包含文件内容的外部实体，并在应用程序的响应中返回。</p>
</li>
<li>
<p>执行SSRF攻击，其中外部实体是基于后端系统的URL定义的，如：</p>
</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY xxe SYSTEM "http://127.0.0.1:8080" &gt;探测端口；</span><br><span class="line"></span><br><span class="line"> &lt;!ENTITY xxe SYSTEM "expect://id" &gt;执行命令；</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>
<p>敏感文件泄露:无回显读取本地敏感文件(Blind OOB XXE)，敏感数据从应用服务器传输到攻击者的服务器上。</p>
</li>
<li>
<p>通过Blind XXE错误消息检索数据是否存在，攻击者可以触发包含敏感数据的解析错误消息。<br>
具体的攻击手段和场景在案例中说明。</p>
</li>
<li>
<p>拒绝服务攻击</p>
</li>
<li>
<p>服务器端请求伪造</p>
</li>
<li>
<p>端口扫描（解析器所在域）</p>
</li>
</ul>
<h3 id="Defense-v4"><a class="header-anchor" href="#Defense-v4">¶</a>Defense</h3>
<p>开发人员培训是识别和减少XXE缺陷的关键，此外，防止XXE 缺陷还需要：</p>
<ul>
<li>尽可能使用简单的数据格式（如：JSON），避免对敏感数据进行序列化。</li>
<li>及时修复或更新应用程序或底层操作系统使用的所有XML处理器和库。同时，通过依赖项检测，将SOAP更新到1.2版本或更高版本。</li>
<li>参考《 OWASP Cheat Sheet ‘XXE Prevention‘ 》，在应用程序的所有XML解析器中禁用XML外部实体和DTD进程。</li>
<li>在服务器端实施积极的（“白名单”）输入验证、过滤和清理，以防止在XML文档、标题或节点中出现恶意数据。</li>
<li>验证XML或XSL文件上传功能是否使用XSD验证或其他类似验证方法来验证上传的XML文件。</li>
<li>尽管在许多集成环境中，手动代码审查是大型、复杂应用程序的最佳选择，但是SAST 工具可以检测源代码中的XXE漏洞。</li>
<li>如果无法实现这些控制，请考虑使用虚拟修复程序、API安全网关或Web应用程序防火墙（ WAF ）来检测、监控和防止XXE攻击。</li>
</ul>
<h3 id="References-v3"><a class="header-anchor" href="#References-v3">¶</a>References</h3>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/backlion/p/9302528.html">https://www.cnblogs.com/backlion/p/9302528.html</a></p>
<h2 id="失效的访问控制Broken-Access-Control"><a class="header-anchor" href="#失效的访问控制Broken-Access-Control">¶</a>失效的访问控制Broken Access Control</h2>
<p>Restrictions on what authenticated users are allowed to do are often not properly enforced. Attackers can exploit these flaws to access unauthorized functionality and/or data, such as access other users’ accounts, view sensitive files, modify other users’ data, change access rights, etc.</p>
<h3 id="Causes-v5"><a class="header-anchor" href="#Causes-v5">¶</a>Causes</h3>
<p>大多数Web页面需要验证功能级别的访问权限。但是，服务器需要在每个功能被访问时在服务器端执行相同的访问控制检查。如果请求没有被验证，攻击者能够伪造请求以在未经适当授权时访问某些页面。</p>
<h3 id="Damage-v5"><a class="header-anchor" href="#Damage-v5">¶</a>Damage</h3>
<ul>
<li>访问其他用户的账号</li>
<li>浏览敏感文件：文件包含/目录遍历<br>
许多web应用使用文件管理作为它们日常操作的一部分。但他们使用没有被好好设计的输入验证方法，攻击者可以利用（这个漏洞）来修改或写入文件，甚至执行任意代码。</li>
<li>修改其他用户数据</li>
<li>改变访问权限、权限绕过（水平越权）<br>
用户未经过身份验证访问资源，或注销后仍可访问资源，对不同用户访问的资源没有做很好的校验，如标准用户可访问管理员资源，或访问其他用户私有资源等。</li>
<li>权限提升（垂直越权）<br>
权限提升是指用户权限从一个阶段提升到另一个阶段的问题，当用户访问的资源比通常情况下访问到的资源更多时，就发生了权限提示漏洞，应用程序应该阻止该权限提升或更改。权限提升一般是由于应用程序自身的缺陷引起的，最后导致程序执行的操作拥有比开发人员或系统管理员预期更多的权限。</li>
<li>不安全直接对象的引用<br>
当应用程序根据用户提供的输入提供对对象的直接访问时，会发生不安全的直接对象引用。 攻击者可以直接绕过授权并访问系统中的资源，例如数据库记录或文件。</li>
</ul>
<p>由于应用程序获取用户提供的输入并使用它来检索对象而不执行足够的授权检查。不安全的直接对象引用允许攻击者通过修改用于直接指向对象的参数值来直接绕过授权和访问资源。这些资源可以是属于其他用户的数据库条目，系统中的文件等。</p>
<h3 id="Defense-v5"><a class="header-anchor" href="#Defense-v5">¶</a>Defense</h3>
<p>访问控制只有在受信服务器端代码或没有服务器的 API 中有效，这样这样攻击者才无法修改访问控制检查或元数据。</p>
<ul>
<li>除公有资源外，默认情况下拒绝访问。</li>
<li>使用一次性的访问控制机制，并在整个应用程序中不断重用它们，包括最小化CORS使用。</li>
<li>建立访问控制模型以强制执行所有权记录，而不是接受用户创建、读取、更新或删除的任何记录。</li>
<li>域访问控制对每个应用程序都是唯一的，但业务限制要求应由域模型强制执行。</li>
<li>禁用 Web服务器目录列表，并确保文件元数据（如：git）不存在于 Web的根目录中。</li>
<li>记录失败的访问控制，并在适当时向管理员告警（如：重复故障）。</li>
<li>对API和控制器的访问进行速率限制，以最大限度地降低自动化攻击工具的危害。</li>
<li>当用户注销后，服务器上的JWT令牌应失效。开发人员和 QA人员应包括功能访问控制单元和集成测试人员。</li>
<li>基于角色的访问控制（RBAC）<br>
在基于角色的访问控制（RBAC）中，访问决策基于个人在组织或用户群中的角色和职责。<br>
定义角色的过程通常基于分析组织的基本目标和结构，并且通常与安全策略相关联。例如，在医疗机构中，用户的不同角色可能包括医生，护士，服务员，护士，患者等等。显然，这些成员需要不同级别的访问才能执行其功能，但也需要根据安全政策和任何相关法规（HIPAA，Gramm-Leach-Bliley等）。<br>
RBAC访问控制框架应该为Web应用程序安全管理员提供确定的“谁可以执行哪些操作，何时，从何处，以何种顺序以及在某些情况下在什么关系环境下“执行操作的能力。</li>
</ul>
<h2 id="安全配置错误Security-Misconfiguration"><a class="header-anchor" href="#安全配置错误Security-Misconfiguration">¶</a>安全配置错误Security Misconfiguration</h2>
<p>Security misconfiguration is the most commonly seen issue. This is commonly a result of insecure default configurations, incomplete or ad hoc configurations, open cloud storage, misconfigured HTTP headers, and verbose error messages containing sensitive information. Not only must all operating systems, frameworks, libraries, and applications be securely configured, but they must be patched/upgraded in a timely fashion.</p>
<h3 id="Causes-v6"><a class="header-anchor" href="#Causes-v6">¶</a>Causes</h3>
<ul>
<li>不安全的默认配置</li>
<li>不完整的或自组织配置</li>
<li>开放云存储</li>
<li>HTTP头的错误配置</li>
<li>包含敏感信息的冗余错误信息</li>
</ul>
<h3 id="Damage-v6"><a class="header-anchor" href="#Damage-v6">¶</a>Damage</h3>
<p>这些漏洞使攻击者能经常访问一些未授权的系统数据或功能。有时，这些漏洞导致系统的完全攻破。业务影响取决于应用程序和数据的保护需求。</p>
<h3 id="Defense-v6"><a class="header-anchor" href="#Defense-v6">¶</a>Defense</h3>
<p>应实施安全的安装过程，包括：</p>
<ul>
<li>一个可以快速且易于部署在另一个锁定环境的可重复的加固过程。开发、质量保证和生产环境都应该进行相同配置，并且，在每个环境中使用不同的密码。这个过程应该是自动化的，以尽量减少<br>
安装一个新安全环境的耗费。</li>
<li>搭建最小化平台，该平台不包含任何不必要的功能、组件、文档和示例。移除或不安装不适用的功能和框架。</li>
<li>检查和修复安全配置项来适应最新的安全说明、更新和补丁，并将其作为更新管理过程的一部分，（参见A9：2017-使用含有已知漏洞的组件）。在检查过程中，应特别注意云存储权限（如：S3桶权限）。</li>
<li>一个能在组件和用户间提供有效的分离和安全性的分段应用程序架构，包括：分段、容器化和云安全组。</li>
<li>向客户端发送安全指令，如：安全标头。</li>
<li>在所有环境中能够进行正确安全配置和设置的自动化过程。</li>
</ul>
<h2 id="跨站脚本Cross-Site-Scripting（XSS）"><a class="header-anchor" href="#跨站脚本Cross-Site-Scripting（XSS）">¶</a>跨站脚本Cross-Site Scripting（XSS）</h2>
<p>XSS flaws occur whenever an application <strong>includes untrusted data in a new web page without proper validation or escaping</strong>, or updates an existing web page with user-supplied data using a browser API that can create HTML or JavaScript. XSS allows attackers to execute scripts in the victim’s browser which can hijack（劫持） user sessions, deface web sites, or redirect the user to malicious sites.</p>
<h3 id="Causes-v7"><a class="header-anchor" href="#Causes-v7">¶</a>Causes</h3>
<p>在一个新网页中不带验证和绕过地包含不信任的数据，或者用用户提供的数据通过浏览器接口来更新已有网页（可以创建HTML或JS）</p>
<h3 id="Damage-v7"><a class="header-anchor" href="#Damage-v7">¶</a>Damage</h3>
<ul>
<li>劫持用户会话</li>
<li>毁坏网站</li>
<li>将用户重定向到恶意网站</li>
</ul>
<h3 id="Defense-v7"><a class="header-anchor" href="#Defense-v7">¶</a>Defense</h3>
<p>防止XSS需要将不可信数据与动态的浏览器内容区分开。这可以通过如下步骤实现：</p>
<ul>
<li>使用设计上就会自动编码来解决XSS问题的框架，如：Ruby 3.0或 React JS。了解每个框架的XSS保护的局限性，并适当地处理未覆盖的用例。</li>
<li>为了避免反射式或存储式的XSS漏洞，最好的办法是根据HTML输出的上下文（包括：主体、属性、JavaScript、CSS或URL）</li>
<li>对所有不可信的HTTP请求数据进行恰当的转义 。更多关于数据转义技术的信息见：《OWASP Cheat Sheet ‘XSS Prevention’》</li>
<li>在客户端修改浏览器文档时，为了避免DOM XSS攻击，最好的选择是实施上下文敏感数据编码。如果这种情况不能避免，可以采用《OWASP Cheat Sheet ‘DOM based XSS Prevention ‘》描述的类似上下文敏感的转义技术应用于浏览器API。</li>
<li>使用内容安全策略（CSP）是对抗XSS的深度防御策略。如果不存在可以通过本地文件放置恶意代码的其他漏洞（例如：路径遍历覆盖和允许在网络中传输的易受攻击的库），则该策略是有效的。</li>
</ul>
<h2 id="不安全的反序列化Insecure-Deserialization"><a class="header-anchor" href="#不安全的反序列化Insecure-Deserialization">¶</a>不安全的反序列化Insecure Deserialization</h2>
<p>Insecure deserialization often leads to remote code execution. Even if deserialization flaws do not result in remote code execution, they can be used to perform attacks, including replay attacks, injection attacks, and privilege escalation attacks.</p>
<h3 id="什么是序列化-反序列化？"><a class="header-anchor" href="#什么是序列化-反序列化？">¶</a>什么是序列化/反序列化？</h3>
<p>序列化（serialization）在计算机科学的资料处理中，是指将数据结构或对象状态转换成可取用格式（例如存成文件，存于缓冲，或经由网络中发送），以留待后续在相同或另一台计算机环境中，能恢复原先状态的过程。依照序列化格式重新获取字节的结果时，可以利用它来产生与原始对象相同语义的副本。对于许多对象，像是使用大量引用的复杂对象，这种序列化重建的过程并不容易。面向对象中的对象序列化，并不概括之前原始对象所关系的函数。这种过程也称为对象编组（marshalling）。从一系列字节提取数据结构的反向操作，是反序列化（也称为解编组、deserialization、unmarshalling）。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">个人理解：</span><br><span class="line">序列化：对象到字节流；反序列化：字节流到对象</span><br></pre></td></tr></tbody></table></figure>
<h3 id="Causes-v8"><a class="header-anchor" href="#Causes-v8">¶</a>Causes</h3>
<p>PHP 的反序列化漏洞也叫PHP 对象注⼊，是⼀个⾮常常⻅的漏洞，这种漏洞充某些场景下虽然有些难以利⽤，但是⼀旦利⽤成功就会造成⾮常危险的后果。</p>
<p>漏洞形成的根本原因就是程序没有对⽤户输⼊的反序列化字符串进⾏检测，导致反序列化过程可以被恶意控制，进⽽造成代码执⾏、GetShell 等⼀系列不可控的后果。反序列化漏洞并不是PHP 特有的，也存在与Java、Python 语⾔中。其原理基本相同。在Java反序列化中，会调用被反序列化的readObject方法，当readObject方法书写不当时就会引发漏洞</p>
<h3 id="Damage-v8"><a class="header-anchor" href="#Damage-v8">¶</a>Damage</h3>
<ul>
<li>远程代码执行</li>
<li>重放攻击</li>
<li>注入攻击</li>
<li>提权攻击</li>
</ul>
<h3 id="Defense-v8"><a class="header-anchor" href="#Defense-v8">¶</a>Defense</h3>
<p>唯一安全的架构模式是不接受来自不受信源的序列化对象，或使用只允许原始数据类型的序列化媒体。<br>
如果上述不可能的话，考虑使用下述方法：</p>
<ul>
<li>执行完整性检查，如：任何序列化对象的数字签名，以防止恶意对象创建或数据篡改。</li>
<li>在创建对象之前强制执行严格的类型约束，因为代码通常被期望成一组可定义的类。绕过这种技术的方法已经被证明，所以完全依赖于它是不可取的。</li>
<li>如果可能，隔离运行那些在低特权环境中反序列化的代码。</li>
<li>记录反序列化的例外情况和失败信息，如：传入的类型不是预期的类型，或者反序列处理引发的例外情况。</li>
<li>限制或监视来自于容器或服务器传入和传出的反序列化网络连接。</li>
<li>监控反序列化，当用户持续进行反序列化时，对用户进行警告。</li>
</ul>
<h2 id="使用含有已知漏洞的组件"><a class="header-anchor" href="#使用含有已知漏洞的组件">¶</a>使用含有已知漏洞的组件</h2>
<p>Using Components with Known Vulnerabilities<br>
Using Components with Known Vulnerabilities<br>
Using Components with Known Vulnerabilities<br>
Using Components with Known Vulnerabilities</p>
<p>Components, such as libraries, frameworks, and other software modules, run with the same privileges as the application. If a vulnerable component is exploited, such an attack can facilitate serious data loss or server takeover. Applications and APIs using components with known vulnerabilities may undermine application defenses and enable various attacks and impacts.</p>
<h3 id="Causes-v9"><a class="header-anchor" href="#Causes-v9">¶</a>Causes</h3>
<p>用了含有漏洞的库、框架、软件模块等等</p>
<h3 id="Damage-v9"><a class="header-anchor" href="#Damage-v9">¶</a>Damage</h3>
<p>破坏应用程序的安全防护，让各种攻击得以执行</p>
<h3 id="Defense-v9"><a class="header-anchor" href="#Defense-v9">¶</a>Defense</h3>
<p>应该制定一个补丁管理流程：</p>
<ol>
<li>移除不使用的依赖、不需要的功能、组件、文件和文档。</li>
<li>利用如 versions、DependencyCheck 、retire.js等工具来持续的记录客户端和服务器端以及它们的依赖库的版本信息。持续监控如CVE 和 NVD等是否发布已使用组件的漏洞信息，可以使用软件分析工具来自动完成此功能。订阅关于使用组件安全漏洞的警告邮件。</li>
<li>仅从官方渠道安全的获取组件，并使用签名机制来降低组件被篡改或加入恶意漏洞的风险</li>
<li>监控那些不再维护或者不发布安全补丁的库和组件。如果不能打补丁，可以考虑部署虚拟补丁来监控、检测或保护。</li>
<li>每个组织都应该制定相应的计划，对整个软件生命周期进行监控、评审、升级或更改配置。</li>
</ol>
<h2 id="不足的日志记录和监控Insufficient-Logging-Monitoring"><a class="header-anchor" href="#不足的日志记录和监控Insufficient-Logging-Monitoring">¶</a>不足的日志记录和监控Insufficient Logging &amp; Monitoring</h2>
<p>Insufficient logging and monitoring, coupled with missing or ineffective integration with incident response, allows attackers to further attack systems, maintain persistence, pivot（以……为中心旋转） to more systems, and tamper, extract, or destroy data. Most breach studies show time to detect a breach is over 200 days, typically detected by external parties rather than internal processes or monitoring.</p>
<h3 id="Causes-v10"><a class="header-anchor" href="#Causes-v10">¶</a>Causes</h3>
<p>不足的日志和监控系统，缺失的或无效的事件相应</p>
<h3 id="Damage-v10"><a class="header-anchor" href="#Damage-v10">¶</a>Damage</h3>
<p>让攻击者可以更深入地攻击系统，毁坏数据</p>
<h3 id="Defense-v10"><a class="header-anchor" href="#Defense-v10">¶</a>Defense</h3>
<p>根据应用程序存储或处理的数据的风险：:</p>
<ul>
<li>确保所有登录、访问控制失败、输入验证失败能够被记录到日志中去，并保留足够的用户上下文信息，以识别可疑或恶意帐户，并为后期取证预留足够时间。</li>
<li>确保日志以一种能被集中日志管理解决方案使用的形式生成</li>
<li>确保高额交易有完整性控制的审计信息，以防止篡改或删除，例如审计信息保存在只能进行记录增加的数据库表中。</li>
<li>建立有效的监控和告警机制，使可疑活动在可接受的时间内被发现和应对。</li>
<li>建立或采取一个应急响应机制和恢复计划，例如：NIST 800-61 rev 2或更新版本。</li>
</ul>
<p>目前已有商业的和开源的应用程序防护框架（例如：OWASP AppSensor）、Web应用防火墙（例如 ：Modsecurity with the OWASP Core Rule Set）、带有自定义仪表盘和告警功能的日志关联软件。</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/14/Software-Security-First-Class/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/14/Software-Security-First-Class/" class="post-title-link" itemprop="url">Software Security First Class</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-14 14:14:46" itemprop="dateCreated datePublished" datetime="2020-09-14T14:14:46+08:00">2020-09-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-17 16:34:02" itemprop="dateModified" datetime="2020-09-17T16:34:02+08:00">2020-09-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4>课外小说与视频</h4>
零日
<h4>调研报告</h4>
暗网

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/14/Chapter1-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BC%95%E8%A8%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/14/Chapter1-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%BC%95%E8%A8%80/" class="post-title-link" itemprop="url">Chapter1 网络安全引言</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-14 09:31:57" itemprop="dateCreated datePublished" datetime="2020-09-14T09:31:57+08:00">2020-09-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-28 02:13:13" itemprop="dateModified" datetime="2020-12-28T02:13:13+08:00">2020-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/%E3%80%8A%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%9F%BA%E7%A1%80%EF%BC%9A%E5%BA%94%E7%94%A8%E4%B8%8E%E6%A0%87%E5%87%86%EF%BC%88E5%EF%BC%89%E3%80%8B/" itemprop="url" rel="index"><span itemprop="name">《网络安全基础：应用与标准（E5）》</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="1-1-计算机安全概念"><a class="header-anchor" href="#1-1-计算机安全概念">¶</a>1.1 计算机安全概念</h2>
<h4 id="（1）计算机安全"><a class="header-anchor" href="#（1）计算机安全">¶</a>（1）计算机安全</h4>
<p><strong>用于保护数据安全和防范黑客的工具集合的通用名称</strong></p>
<p>为什么会出现计算机安全呢？<br>
是因为引入了计算机，人们需要保护信息的自动工具了，而不是原始的物理保护（指保险箱hhh）</p>
<h4 id="（2）网络（互联网）安全"><a class="header-anchor" href="#（2）网络（互联网）安全">¶</a>（2）网络（互联网）安全</h4>
<p><strong>分布式系统的引入</strong>、网络以及在计算机终端用户与计算机之间、计算机与计算机之间进行通信的工具应用，其中都包含<strong>数据传输</strong>，需要网络安全措施来保护数据。<br>
<em>（其实更专业的术语叫互联网安全）</em></p>
<h3 id="1-1-1-计算机安全定义"><a class="header-anchor" href="#1-1-1-计算机安全定义">¶</a>1.1.1 计算机安全定义</h3>
<p>这是NIST对计算机安全的定义：</p>
<p>对某个自动化信息系统的保护措施，其目的在于实现信息系统资源的<strong>完整性</strong>、<strong>可用性</strong>以及<strong>机密性</strong>（包括硬件、软件、固件、信息/数据、电信）。</p>
<h5 id="（1）完整性"><a class="header-anchor" href="#（1）完整性">¶</a>（1）完整性</h5>
<ol>
<li>数据完整性：<strong>只能通过已授权的方式</strong>来更改数据</li>
<li>系统完整性：保证系统<strong>只做它被期待做的事</strong>，不会被奇怪的东西控制</li>
</ol>
<p>总结：有种感觉是完整性就是关于只能按照预期的什么什么……</p>
<h5 id="（2）机密性"><a class="header-anchor" href="#（2）机密性">¶</a>（2）机密性</h5>
<ol>
<li>数据机密性：隐私数据不泄漏给未授权的个体</li>
<li>隐私性：每个人可以控制自己的信息</li>
</ol>
<h5 id="（3）可用性"><a class="header-anchor" href="#（3）可用性">¶</a>（3）可用性</h5>
<p>服务不会拒绝已授权的用户</p>
<p>这三者取英文首字母组成CIA三元组。</p>
<p>从损失的角度，可以作如下描述：</p>
<ul>
<li>机密性：非授权的信息泄露</li>
<li>完整性：未经授权的信息修改和破坏</li>
<li>可用性：访问或使用的中断</li>
</ul>
<p>另外，也有人说可以加入真实性（信息是否来自可靠的信息源）、可计量性（能够追踪安全违规的责任方）的概念。</p>
<p>书P4-5有例子，说明了低、中、高三种级别的损失，以及具体实例下的数据机密性、完整性和可用性的具体内容。</p>
<h3 id="1-1-2-计算机安全挑战"><a class="header-anchor" href="#1-1-2-计算机安全挑战">¶</a>1.1.2 计算机安全挑战</h3>
<p>见书P5-6，说明了为什么计算机安全和网络安全复杂且多变。</p>
<h2 id="1-2-OSI安全体系结构"><a class="header-anchor" href="#1-2-OSI安全体系结构">¶</a>1.2 OSI安全体系结构</h2>
<p>OSI模型关注的包括以下三个方面：</p>
<ol>
<li>安全攻击</li>
<li>安全机制：检测、防范与恢复</li>
<li>安全服务：加强安全性，防范攻击</li>
</ol>
<p>关于威胁和攻击的辨析：个人觉得威胁是潜在危险，攻击是破坏手段</p>
<h2 id="1-3-安全攻击"><a class="header-anchor" href="#1-3-安全攻击">¶</a>1.3 安全攻击</h2>
<p>可以分为两大类：主动和被动攻击</p>
<ul>
<li>主动：试图改变系统资源或影响系统操作</li>
<li>被动：企图了解或利用系统信息<strong>但不影响系统资源</strong></li>
</ul>
<h3 id="1-3-1-被动攻击"><a class="header-anchor" href="#1-3-1-被动攻击">¶</a>1.3.1 被动攻击</h3>
<h4 id="（1）内容"><a class="header-anchor" href="#（1）内容">¶</a>（1）内容</h4>
<ul>
<li>本质：窃听或监视</li>
<li>目标：获取传输的数据信息</li>
<li>两种形式：消息内容泄露（传输的文件中包含机密信息）和流量分析攻击（观察交换信息的频率和长度来猜测相关通信性质）</li>
</ul>
<h4 id="（2）防范"><a class="header-anchor" href="#（2）防范">¶</a>（2）防范</h4>
<p>由于不改变数据，所以很难检测；一般都是防范为主（如加密），检测为次</p>
<h3 id="1-3-2-主动攻击"><a class="header-anchor" href="#1-3-2-主动攻击">¶</a>1.3.2 主动攻击</h3>
<h4 id="（1）内容-v2"><a class="header-anchor" href="#（1）内容-v2">¶</a>（1）内容</h4>
<ul>
<li>本质：数据流的改写、错误数据流的添加</li>
</ul>
<h4 id="（2）分类"><a class="header-anchor" href="#（2）分类">¶</a>（2）分类</h4>
<ol>
<li>假冒：比如可以让某个实体冒充别人后获得更多特权</li>
<li>重放：=被动捕获数据+主动重新传输</li>
<li>改写消息：合法消息被篡改——被延迟、重排、被改内容等等</li>
<li>拒绝服务：</li>
</ol>
<h4 id="（3）特点"><a class="header-anchor" href="#（3）特点">¶</a>（3）特点</h4>
<p>与被动攻击相反，主动攻击不好防范</p>
<h2 id="1-4-安全服务"><a class="header-anchor" href="#1-4-安全服务">¶</a>1.4 安全服务</h2>
<p>安全服务定义：</p>
<blockquote>
<p>对系统资源或通信的保护处理</p>
</blockquote>
<p>安全策略由安全服务实现，安全服务由安全机制实现</p>
<h3 id="1-4-1-认证"><a class="header-anchor" href="#1-4-1-认证">¶</a>1.4.1 认证</h3>
<h4 id="1-功能"><a class="header-anchor" href="#1-功能">¶</a>1. 功能</h4>
<ul>
<li>确保每个实体都是对方所要求连接的那一方</li>
<li>确保不会受非法第三方干扰（若被干扰，有可能实体被假冒）</li>
</ul>
<h4 id="2-两种特定认证服务"><a class="header-anchor" href="#2-两种特定认证服务">¶</a>2. 两种特定认证服务</h4>
<ul>
<li>对等实体认证：如TCP中</li>
<li>数据源认证：帮助确保数据来源</li>
</ul>
<h3 id="1-4-2-访问控制"><a class="header-anchor" href="#1-4-2-访问控制">¶</a>1.4.2 访问控制</h3>
<h4 id="1-功能-v2"><a class="header-anchor" href="#1-功能-v2">¶</a>1. 功能</h4>
<p>限制via通信链路访问主机系统和应用程序</p>
<p>那么问题来了，我们怎么知道限制哪些呢？<br>
——可以基于认证，限制那些不该获得访问权限的实体</p>
<h3 id="1-4-3-数据机密性"><a class="header-anchor" href="#1-4-3-数据机密性">¶</a>1.4.3 数据机密性</h3>
<h4 id="1-功能-v3"><a class="header-anchor" href="#1-功能-v3">¶</a>1. 功能</h4>
<p>保护被传输的数据不遭受被动攻击（窃听+流量分析）</p>
<h4 id="2-两种服务层次"><a class="header-anchor" href="#2-两种服务层次">¶</a>2. 两种服务层次</h4>
<ul>
<li>广义：一定时期内两者传输的所有数据</li>
<li>狭义：对单个消息或者消息的某个字段</li>
</ul>
<h3 id="1-4-4-数据完整性"><a class="header-anchor" href="#1-4-4-数据完整性">¶</a>1.4.4 数据完整性</h3>
<h4 id="1-功能-v4"><a class="header-anchor" href="#1-功能-v4">¶</a>1. 功能</h4>
<p>保证数据收发一致，有的在检测到数据被篡改以后还会自动恢复</p>
<h3 id="1-4-5-不可抵赖性"><a class="header-anchor" href="#1-4-5-不可抵赖性">¶</a>1.4.5 不可抵赖性</h3>
<p>不能否认自己传输过某个消息</p>
<h3 id="1-4-6-可用性服务"><a class="header-anchor" href="#1-4-6-可用性服务">¶</a>1.4.6 可用性服务</h3>
<p>主要是为了解决DOS攻击引起的安全问题</p>
<h2 id="1-5-安全服务"><a class="header-anchor" href="#1-5-安全服务">¶</a>1.5 安全服务</h2>
<p>安全机制被分为两类：</p>
<ul>
<li>特定安全机制：可以合并到特定的协议层</li>
<li>普适安全机制：没有指定特定的协议层</li>
</ul>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20201224232709.png" alt=""></p>
<p>安全服务与机制之间的关系：（竖着为服务）</p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20201224232854.png" alt=""></p>
<h2 id="1-6-网络安全模型"><a class="header-anchor" href="#1-6-网络安全模型">¶</a>1.6 网络安全模型</h2>
<p>首先咱们了解一个概念——逻辑信息通道：</p>
<blockquote>
<p>可由两个信息主体，src与dst之间的路由、使用的协议来确定</p>
</blockquote>
<h3 id="1-6-1-通用安全模型"><a class="header-anchor" href="#1-6-1-通用安全模型">¶</a>1.6.1 通用安全模型</h3>
<p>网络安全模型如下图：</p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20201224233728.png" alt=""></p>
<p>注意上图圈圈处，显示着安全技术的主要两个部分：</p>
<ul>
<li>安全相关的转换：比如加密算法</li>
<li>秘密信息：比如加密密钥</li>
</ul>
<p>两者共同作用，将原始消息转换为秘密消息</p>
<p>对于图中的可信第三方，它一般承担如下任务：</p>
<ul>
<li>负责分发秘密信息，并对攻击者隐藏</li>
<li>仲裁两者之间的纷争</li>
</ul>
<p>设计安全服务要做到的四个基本任务：</p>
<ul>
<li>设计“安全相关的转换”算法</li>
<li>生成秘密信息</li>
<li>设计“分发和共享秘密信息”的方法</li>
<li>指定两者之间的协议</li>
</ul>
<h3 id="1-6-2-网络访问安全模型"><a class="header-anchor" href="#1-6-2-网络访问安全模型">¶</a>1.6.2 网络访问安全模型</h3>
<p>除了1.6.1中提到的通用模型，其他可以用网络访问安全模型来描述<br>
这种模型是为了保护系统免遭有害访问所做，可用下图表示：</p>
<p><img src="https://raw.githubusercontent.com/Crestiny/BlogImgBed/main/img/20201225002542.png" alt=""></p>
<h4 id="1-两种有害访问"><a class="header-anchor" href="#1-两种有害访问">¶</a>1. 两种有害访问</h4>
<ul>
<li>入侵到通过网络能访问的系统</li>
<li>利用计算机系统逻辑上的弱点，能影响应用程序，这种情况下，程序面临两种威胁:
<ul>
<li>信息访问威胁：没访问权限的用户<strong>干了不该干的事</strong></li>
<li>服务威胁：合法用户<strong>不能干该干的事</strong></li>
</ul>
</li>
</ul>
<h4 id="2-解决有害访问的安全机制"><a class="header-anchor" href="#2-解决有害访问的安全机制">¶</a>2. 解决有害访问的安全机制</h4>
<p>有两大范畴：</p>
<ul>
<li>看门人功能：用口令登录，拒绝未授权用户</li>
<li>屏蔽逻辑：检测蠕虫等攻击，并拒绝它们</li>
</ul>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/10/Problems-during-Solving-2020CUMCM-A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/10/Problems-during-Solving-2020CUMCM-A/" class="post-title-link" itemprop="url">Problems during Solving 2020CUMCM-A</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-10 19:13:04" itemprop="dateCreated datePublished" datetime="2020-09-10T19:13:04+08:00">2020-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-14 09:17:01" itemprop="dateModified" datetime="2020-09-14T09:17:01+08:00">2020-09-14</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Contest/" itemprop="url" rel="index"><span itemprop="name">Contest</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <center><h1>待查问题</h1></center>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">怎么根据相邻温区之间的温度求温区间隙和边缘的温度？</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">什么关系？怎么预测？</span><br></pre></td></tr></table></figure>
<center><h1>可参考网址</h1></center>
<p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E7%86%B1%E5%82%B3%E5%B0%8E%E6%96%B9%E7%A8%8B%E5%BC%8F">热传导方程式简介</a><br>
<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Zw53kxy7yL0">回流炉视频</a><br>
<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=xn_oN8ZMaMk">回流炉原理更清晰</a><br>
<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=NQiAcJxYfAs">回流炉视频2</a><br>
<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=q37g3RflFQ0">物体走过对应温度曲线变化</a><br>
<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=4pVUMda2prQ">物体走过对应温度曲线变化2-best oven setup</a><br>
<a target="_blank" rel="noopener" href="https://blog.51cto.com/9269309/1865554">牛顿冷却定律</a><br>
<a href></a><br>
<a href></a><br>
<a href></a><br>
<a href></a></p>
<center><h1>名词解释</h1></center>
<h3>PCB</h3>
印刷电路板，又称印制电路板，印刷线路板，常用英文缩写PCB（Printed circuit board）或PWB（Printed wire board），是电子元件的支撑体，在这其中有金属导体作为连接电子元器件的线路。
<p>reflow oven</p>
<p>reflow profile</p>
<p>soldering  焊接</p>
<p>SMT<br>
SMT贴片指的是在PCB基础上进行加工的系列工艺流程的简称，PCB（Printed Circuit Board)为印刷电路板。SMT是表面组装技术（表面贴装技术）（Surface Mounted Technology的缩写），是电子组装行业里最流行的一种技术和工艺。</p>
<p>非稳态导热</p>
<p>导热和热传导的区别<br>
材料直接传导热量的能力称为热传导率,或称热导率.热导率定义为单位截面、长度的材料在单位温差下和单位时间内直接传导的热量.热导率的单位为瓦每米每开尔文((W/m.K)). 导热率:物体传导热量的能力,又称为热导率 . 所以,我感觉你提出这两个概念没有区别</p>
<h3>辨析几个概念</h3>
这些公式的适用范围？
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">牛顿冷却定律</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">傅里叶导热定律</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">热传导与导热</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">牛顿冷却定律</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">稳态导热</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">非稳态导热</span><br></pre></td></tr></table></figure>
<center><h1>或许可用的公式</h1></center>
<p>热传导方程</p>
<p>牛顿冷却定律</p>
<p>傅里叶定律</p>
<p>Crank − Nicholson 方法</p>
<center><h1>一些假设</h1></center>
1. 只考虑热对流、热传导
2. 是从炉前区域就开始的
3. 假设是热风回流焊炉，热对流传热为主
<center><h1>一些想法</h1></center>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/07/Database-Trigger/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/07/Database-Trigger/" class="post-title-link" itemprop="url">Database Trigger</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-07 05:54:42" itemprop="dateCreated datePublished" datetime="2020-09-07T05:54:42+08:00">2020-09-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-28 02:13:13" itemprop="dateModified" datetime="2020-12-28T02:13:13+08:00">2020-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>触发器类似于约束，但比约束更灵活</p>
<h3 id="定义触发器"><a class="header-anchor" href="#定义触发器">¶</a>定义触发器</h3>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER &lt;触发器名&gt;</span><br><span class="line">  BEFORE|AFTER &lt;触发事件&gt; ON &lt;表名&gt;</span><br><span class="line">  FOR EACH ROW|STATEMENT</span><br><span class="line">  [WHEN &lt;触发条件&gt;]</span><br><span class="line">  &lt;触发动作体&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>参数说明：</p>
<ul>
<li>表的创建者才能建立触发器，而且一个表上不是无限个</li>
<li>触发事件：SQL语句动词，另外如UPDATE还可以加上 OF &lt;触发列，…&gt;</li>
<li>触发器类型：行级：有多少行做多少次；语句级：有多少相关语句做多少次</li>
<li>触发动作体：可以是AS + PL/SQL块</li>
</ul>
<h3 id="激活触发器"><a class="header-anchor" href="#激活触发器">¶</a>激活触发器</h3>
<p>搞清楚触发器的激活顺序（定义时间先后）</p>
<h3 id="删除触发器"><a class="header-anchor" href="#删除触发器">¶</a>删除触发器</h3>
<pre><code>DROP TRIGGER &lt;触发器名&gt; ON &lt;表名&gt;;
</code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/07/SQL-Clauses-for-Database-Security/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/07/SQL-Clauses-for-Database-Security/" class="post-title-link" itemprop="url">SQL Clauses for Database Security</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-09-07 05:17:53 / 修改时间：05:40:26" itemprop="dateCreated datePublished" datetime="2020-09-07T05:17:53+08:00">2020-09-07</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <center><h1>对数据的操作权限</h1></center>
<h2>授权</h2>
GRANT语句：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">GRANT &lt;权限&gt; [,&lt;权限&gt;]...</span><br><span class="line">ON &lt;对象类型&gt; &lt;对象名&gt; [,&lt;对象类型&gt; &lt;对象名&gt;]...</span><br><span class="line">TO &lt;用户&gt; [,&lt;用户&gt;]...</span><br><span class="line">[WITH GRANT OPTION];</span><br><span class="line"></span><br><span class="line">参数解释：</span><br><span class="line">- 权限：SQL语句动词、如UPDATE(Sno)、特定ALL PRIVILEGES......</span><br><span class="line">- 对象：其实一般就是写TABLE table-name这样子，也有直接“视图名”的</span><br><span class="line">- 用户：如U1、特定的PUBLIC.......</span><br><span class="line">- 最后一个可选子句：加上代表获得此权限的用户同时也有给别人授予它的权利</span><br></pre></td></tr></table></figure>
<h2>回收权限</h2>
REVOKE语句：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">REVOKE &lt;权限&gt; [,&lt;权限&gt;]...</span><br><span class="line">ON &lt;对象类型&gt; &lt;对象名&gt; [,&lt;对象类型&gt; &lt;对象名&gt;]...</span><br><span class="line">FROM &lt;用户&gt; [,&lt;用户&gt;]...[CASCADE|RESTRICT];</span><br><span class="line"></span><br><span class="line">参数说明：最后可选的是级联收回或限制操作</span><br></pre></td></tr></table></figure>
<center><h1>关于数据库模式的权限</h1></center>
在DBA创建用户时实现
<p>创建用户语句：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE USER &lt;user-name&gt;</span><br><span class="line">[WITH] [DBA|RESOURCE|CONNECT];</span><br><span class="line"></span><br><span class="line">参数说明：最后括号里的是三种权限，默认最后一个，它们对应的可执行操作见下表</span><br></pre></td></tr></table></figure>
<p><img src="/2020/09/07/SQL-Clauses-for-Database-Security/%5CSQL-Clauses-for-Database-Security%5Cquan.png" alt></p>
<center><h1>数据库角色</h1></center>
很神奇的是，角色居然是权限的集合（而非用户的集合）
可以为拥有相同权限的一组用户创建一个角色
<h2>创建</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CREATE ROLE &lt;角色名&gt;；</span><br></pre></td></tr></table></figure>
<h2>授权</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GRANT &lt;权限&gt; [,&lt;权限&gt;]...</span><br><span class="line">ON &lt;对象类型&gt; &lt;对象名&gt; [,&lt;对象类型&gt; &lt;对象名&gt;]...</span><br><span class="line">TO &lt;角色&gt; [,&lt;角色&gt;]...</span><br></pre></td></tr></table></figure>
<h2>用角色授权</h2>
因为角色本质是权限，所以我们可以：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GRANT &lt;角色1&gt; [,&lt;角色2&gt;]...</span><br><span class="line">TO &lt;角色3&gt; [,&lt;角色4&gt;]...</span><br><span class="line">[WITH GRANT OPTION]</span><br></pre></td></tr></table></figure>
<h2>收回角色权限</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">REVOKE &lt;权限&gt; [,&lt;权限&gt;]...</span><br><span class="line">ON &lt;对象类型&gt; &lt;对象名&gt; [,&lt;对象类型&gt; &lt;对象名&gt;]...</span><br><span class="line">FROM &lt;角色1&gt; [,&lt;角色2&gt;]...;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/06/Database-Important-Difficult-Exercises-Collection/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/06/Database-Important-Difficult-Exercises-Collection/" class="post-title-link" itemprop="url">Database Important&Difficult Exercises Collection</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-06 01:05:58" itemprop="dateCreated datePublished" datetime="2020-09-06T01:05:58+08:00">2020-09-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-28 02:13:13" itemprop="dateModified" datetime="2020-12-28T02:13:13+08:00">2020-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="题目"><a class="header-anchor" href="#题目">¶</a>题目</h2>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">证明：任何一个二目关系都是3NF的</span><br></pre></td></tr></tbody></table></figure>
<p>正确。因为关系模式中只有两个属性，所以无传递。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">证明：任何一个二目关系都是BCNF的</span><br></pre></td></tr></tbody></table></figure>
<p>正确。按BCNF的定义，若X-&gt;Y,且Y不是X的子集时，<strong>每个决定因素都包含码</strong>（如果不包含，那就有属性依赖于非码属性啦！就是存在传递依赖咯），对于二目关系决定因素必然包含码。详细证明如下：（任何二元关系模式必定是BCNF）。<br>
证明：设R为一个二目关系R(A1，A2)，则属性A1和A2之间可能存在以下几种依赖关系：<br>
A、A1-&gt;A2，但A2不-&gt;A1，则关系R的码为A1，决定因素都包含码，所以，R是BCNF。<br>
B、A1不-&gt;A2，但A2-&gt;A1，则关系R的码为A2，所以决定因素都包含码，R是BCNF。<br>
C、R的码为(A1，A2)（即A1-&gt;A2，A2-&gt;A1），决定因素都包含码，为BCNF</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">证明：任何一个二目关系都是4NF的</span><br></pre></td></tr></tbody></table></figure>
<p>正确。因为只有两个属性，所以无非平凡的多值依赖。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">判断：</span><br><span class="line">（1）若 R.B→R.A，R.C→R.A，则 R.(B, C)→R.A</span><br><span class="line">（2）若 R.(B, C)→R.A，则 R.B→R.A，R.C→R.A </span><br></pre></td></tr></tbody></table></figure>
<p>（1）正确，貌似还是可以反证的<br>
（2）反例：关系模式 SC（S#，C#，G） 其中有（S#，C#）→G，但是S# 不→ G，C#不→G，也就是说少了一些决定因素就不行了</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">指出下列关系模式是第几范式？并说明理由。</span><br><span class="line">① R（X，Y，Z） F={XY→Z}</span><br><span class="line">② R（X，Y，Z） F={Y→Z，XZ→Y}</span><br><span class="line">③ R（X，Y，Z） F={Y→Z，Y→X，X→Y ， X→ Z}</span><br><span class="line">④ R（X，Y，Z） F={X→Y，X→Z}</span><br><span class="line">⑤ R（W，X，Y，Z） F={X→Z，WX→Y}</span><br><span class="line">``` </span><br><span class="line">（1）码：（X，Y），主属性：X，Y，非主属性：Z</span><br><span class="line">	不存在非主对码的部分函数依赖——2NF</span><br><span class="line">	不存在非主对码的传递函数依赖——3NF</span><br><span class="line">	每个决定因素都包含码——BCNF</span><br><span class="line">	除了平凡的、函数依赖的，没有其他多值依赖——4NF</span><br><span class="line">	4NF</span><br><span class="line">（2）码：（X，Z），主属性：X，Z，非主属性：Y</span><br><span class="line">	不存在非主对码的部分函数依赖——2NF</span><br><span class="line">	不存在非主对码的传递函数依赖——3NF</span><br><span class="line">	不是每个决定因素都包含码</span><br><span class="line">	3NF</span><br><span class="line">（3）码：X，Y，主属性：X，Y，非主属性：Z</span><br><span class="line">	不存在非主对码的部分函数依赖——2NF</span><br><span class="line">	不存在非主对码的传递函数依赖——3NF</span><br><span class="line">	每个决定因素都包含码——BCNF</span><br><span class="line">	除了平凡的、函数依赖的，没有其他多值依赖——4NF</span><br><span class="line">	4NF</span><br><span class="line">（4）码：X，主属性：X，非主属性：Y，Z</span><br><span class="line">	不存在非主对码的部分函数依赖——2NF</span><br><span class="line">	不存在非主对码的传递函数依赖——3NF</span><br><span class="line">	每个决定因素都包含码——BCNF</span><br><span class="line">	除了平凡的、函数依赖的，没有其他多值依赖——4NF</span><br><span class="line">	4NF</span><br><span class="line">（5）码：（W，X），主属性：W，X，非主属性：Y，Z</span><br><span class="line">	存在非主对码的部分函数依赖</span><br><span class="line">	1NF</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>设有关系模式 R(U,F)，其中 U＝ABC，F＝｛A→B，B→C｝，求 F 的闭包 F＋</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">（注：K表示空集）</span><br><span class="line">（1）自反：</span><br><span class="line">k-&gt;K,</span><br><span class="line">A-&gt;K,B-&gt;K,C-&gt;K,</span><br><span class="line">A-&gt;A,B-&gt;B,C-&gt;C,</span><br><span class="line">AB-&gt;K,BC-&gt;K,AC-&gt;K,</span><br><span class="line">AB-&gt;A,AB-&gt;B,BC-&gt;B,BC-&gt;C,AC-&gt;A,AC-&gt;C,</span><br><span class="line">AB-&gt;AB,BC-&gt;BC,AC-&gt;AC,</span><br><span class="line">ABC-&gt;K,</span><br><span class="line">ABC-&gt;A,ABC-&gt;B,ABC-&gt;C,</span><br><span class="line">ABC-&gt;AB,ABC-&gt;BC,ABC-&gt;AC,</span><br><span class="line">ABC-&gt;ABC</span><br><span class="line">（2）增广：</span><br><span class="line">（对于A→B）：A→AB,AB→B,AC→BC</span><br><span class="line">（对于B→C）：AB→AC,B→BC,BC→C</span><br><span class="line">（对于A→C）：A→AC,AB→BC,AC→C</span><br><span class="line">（3）传递：</span><br><span class="line">A-&gt;C,AC-&gt;B,AB-&gt;C</span><br><span class="line"></span><br><span class="line">**如何不重不漏？**</span><br><span class="line">这好像是个NP问题啊....</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>对题 6 的关系模式R，求其候选键并判断A→C和B→A是否属于F＋。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">候选键：A</span><br><span class="line">传递律所以A→C属于</span><br><span class="line">B→A不属于</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>对于关系模式R(ABC)，F={A→BC,BC→A}，求其候选键。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">候选键：A，（B，C）</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>设有关系模式 R(U,F)，其中 U＝ABC，F＝｛A→{B,C},B→C, A→B, {A, B}→C｝，求 Fmin。</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">第一步：分解右边得到F＝｛A→B,A→C,B→C,{A, B}→C｝</span><br><span class="line">第二步：</span><br><span class="line">对于A→B：A在G上的闭包为{A,C}，不含B，可以保留</span><br><span class="line">对于A→C：A在G上的闭包为{A,B,C},含C，不保留</span><br><span class="line">对于B→C：B在G上的闭包为{B},不含C，保留</span><br><span class="line">对于{A, B}→C：AB在G上的闭包为{A,B,C},含C，不保留</span><br><span class="line">F＝｛A→B,B→C｝</span><br><span class="line"></span><br><span class="line">## 一些小疑问</span><br></pre></td></tr></tbody></table></figure>
<p>定义SQL表时，各种数据类型怎么用？</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href="https://www.runoob.com/sql/sql-datatypes-general.html"&gt;是一个比较全面的整理&lt;/a&gt;</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>SQL语句和用户权限相关的那部分内容？</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">见博客“SQL Clauses for Database Security”</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>SQL编程这块我感觉还有好多没见过的词？？？</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">其实那些是PL/SQL来的</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>数据字典和数据库的关系？</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">数据字典实际上是“关于系统数据的数据库”</span><br><span class="line">感觉有点像**元数据**的意思</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>有些复杂的引理记不清楚</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>几种等价的表达：</p>
<ol>
<li>元组表达式</li>
<li>汉语查询句子</li>
<li>关系代数表达式（语言）</li>
<li>域演算表达式（语言）</li>
</ol>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 集合</span><br><span class="line">2. 中文</span><br><span class="line">3. π、ρ</span><br><span class="line">4. 基于屏幕表格的查询语言</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>触发器</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">见博客“Database Trigger”</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>证明的规范写法</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>模式分解算法要背啊</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">背了！分成两组即可！</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>怎么从求一个函数依赖集在某属性集上的投影？怎么根据属性集求对应的函数依赖集（应该是一个意思）</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">![](\Database-Important-Difficult-Exercises-Collection\p.png)</span><br><span class="line">说人话：</span><br><span class="line">假如我们要求F在U上的投影</span><br><span class="line">可以首先在F中剔掉那些左边X或右边Y不包含于U的函数依赖式，余下的应该就可以</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>复杂的查询用SQL有点绕不来</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">其实有时候，多层嵌套也可以用简单粗暴的自然连接连所有来代替，只是后者显然效率不好</span><br><span class="line">除法虽然还是不懂，但是背下来了！</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>几个连接</p>
<pre><code>笛卡尔积：简单粗暴的排列组合，一个X
等值连接：下面有条件
自然连接：下面没有条件

## 一句话知识点
1. 数据库系统中，数据独立性是指：应用程序与数据库的结构之间相互独立
2. 关系数据库包含：内模式、模式、外模式三级模式；分别对应数据库的存储文件、基表、视图
(外模式也就是：子模式/用户模式，是用户看到的数据视图)

## 要背的知识点
1. 数据库系统的特点（物理独立性、逻辑独立性）
2. 数据库系统的三级结构模式
3. 完整性约束条件
4. DBMS主要功能
5. 数据管理技术发展过程
6. 视图和基表的区别
7. SQL特点
8. SQL四种语言（?DQMC）
9. 数据库设计的基本步骤
10. 数据库的维护方法
11. 查询处理步骤
12. 启发式规则
13. 视图的优点

## 要注意的名词解释

## 要熟悉的算法
1. 判别无损连接性
2. 判别保持函数依赖性

</code></pre>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/06/Database-Programming/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/06/Database-Programming/" class="post-title-link" itemprop="url">Database Programming</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-06 00:51:19" itemprop="dateCreated datePublished" datetime="2020-09-06T00:51:19+08:00">2020-09-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-28 02:13:13" itemprop="dateModified" datetime="2020-12-28T02:13:13+08:00">2020-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="静态嵌入式SQL（ESQL）"><a class="header-anchor" href="#静态嵌入式SQL（ESQL）">¶</a>静态嵌入式SQL（ESQL）</h2>
<h3 id="ESQL的通用使用过程"><a class="header-anchor" href="#ESQL的通用使用过程">¶</a>ESQL的通用使用过程</h3>
<h3 id="基本结构"><a class="header-anchor" href="#基本结构">¶</a>基本结构</h3>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL &lt;SQL语句&gt;;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="ESQL和主语言的通信"><a class="header-anchor" href="#ESQL和主语言的通信">¶</a>ESQL和主语言的通信</h3>
<ol>
<li>传递SQL语句执行状态：SQL通信区（SQLCA）</li>
<li>主语言向SQL语句传参：主变量</li>
<li>SQL返回结果：主变量+游标</li>
</ol>
<h3 id="SQL通信区"><a class="header-anchor" href="#SQL通信区">¶</a>SQL通信区</h3>
<p>SQLCA中有一个SQLCODE变量<br>
为SUCCESS代表执行成功，否则就是错误代码</p>
<p>定义SQLCA</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL INCLUDE SQLCA;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="主变量"><a class="header-anchor" href="#主变量">¶</a>主变量</h3>
<p>SQL语句中用了主程序中的变量就叫做主变量<br>
分为输入主变量（主程序输入到SQL）和输出主变量<br>
主变量可以附带一个指示变量，对主变量的值加以说明（比如指示主变量是否为空值）</p>
<p>声明：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL BEGIN DECLARE SECTION;</span><br><span class="line">	声明主变量、指示变量	/*变量的定义就和主程序变量一样*/</span><br><span class="line">	char HSno[9];		/*比如这样*/</span><br><span class="line">EXEC SQL END DECLARE SECTION;</span><br></pre></td></tr></tbody></table></figure>
<p>使用：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:主/指示变量名	/*前面加冒号！*/</span><br></pre></td></tr></tbody></table></figure>
<h3 id="游标"><a class="header-anchor" href="#游标">¶</a>游标</h3>
<p>游标可以看做一个数据缓冲区<br>
SQL语句输出-&gt;游标-&gt;主变量-&gt;主程序</p>
<p>定义游标（为了一个SQL语句）：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL DECLARE [cursor-name] CURSOR FOR</span><br><span class="line">	&lt;SQL语句&gt;；</span><br></pre></td></tr></tbody></table></figure>
<p>打开和关闭游标：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL OPEN [cursor-name]；</span><br><span class="line"></span><br><span class="line">EXEC SQL CLOSE [cursor-name]；</span><br></pre></td></tr></tbody></table></figure>
<p>从游标中取数据到主变量：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">for ( ; ; ){</span><br><span class="line">	EXEC SQL FETCH [cursor-name] INTO :主变量1, :主变量2, ......</span><br><span class="line">	其他操作</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<h3 id="建立和关闭数据库连接"><a class="header-anchor" href="#建立和关闭数据库连接">¶</a>建立和关闭数据库连接</h3>
<h4 id="建立连接"><a class="header-anchor" href="#建立连接">¶</a>建立连接</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL CONNECT TO target[AS connection-name][USER user-name]；</span><br><span class="line">参数解释：</span><br><span class="line">- target:要连接的数据库服务器，标识方法有几种</span><br><span class="line">	如：&lt;dbname&gt;@&lt;hostname&gt;:&lt;port&gt;</span><br><span class="line">- connection-name：应该就是按标识符的命名规矩来</span><br><span class="line">- </span><br></pre></td></tr></tbody></table></figure>
<h4 id="修改连接"><a class="header-anchor" href="#修改连接">¶</a>修改连接</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL SET CONNECTION connection-name;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="关闭连接"><a class="header-anchor" href="#关闭连接">¶</a>关闭连接</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL DISCONNECT [connection];	/*这个方括号里的应该就用数据库的名字dbname*/</span><br></pre></td></tr></tbody></table></figure>
<h4 id="关闭连接前可以来个“提交数据库更新”"><a class="header-anchor" href="#关闭连接前可以来个“提交数据库更新”">¶</a>关闭连接前可以来个“提交数据库更新”</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL COMMIT WORK;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="不用游标的ESQL"><a class="header-anchor" href="#不用游标的ESQL">¶</a>不用游标的ESQL</h3>
<h4 id="查询结果为单记录的SELECT语句"><a class="header-anchor" href="#查询结果为单记录的SELECT语句">¶</a>查询结果为单记录的SELECT语句</h4>
<p>单记录通俗点就是：查询结果只有一行<br>
所以我们既不用循环，也不用游标，用一组主变量就可以了</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL SELECT x,x,x,x</span><br><span class="line">		 INTO :主变量1, :主变量2; :主变量3, :主变量4</span><br><span class="line">		 FROM </span><br><span class="line">		 WHERE</span><br></pre></td></tr></tbody></table></figure>
<h4 id="增删改语句"><a class="header-anchor" href="#增删改语句">¶</a>增删改语句</h4>
<p>UPDATE/DELETE/INSERT INTO</p>
<p>关于指示变量：</p>
<h3 id="用游标的ESQL"><a class="header-anchor" href="#用游标的ESQL">¶</a>用游标的ESQL</h3>
<h4 id="查询结果为多条记录的SELECT语句"><a class="header-anchor" href="#查询结果为多条记录的SELECT语句">¶</a>查询结果为多条记录的SELECT语句</h4>
<p>说明游标、打开游标、循环读记录、关闭游标</p>
<h4 id="CURRENT形式的UPDATE和DELETE语句"><a class="header-anchor" href="#CURRENT形式的UPDATE和DELETE语句">¶</a>CURRENT形式的UPDATE和DELETE语句</h4>
<h4 id="补充：什么是CURRENT形式？"><a class="header-anchor" href="#补充：什么是CURRENT形式？">¶</a>补充：什么是CURRENT形式？</h4>
<h2 id="动态嵌入式SQL（ESQL）"><a class="header-anchor" href="#动态嵌入式SQL（ESQL）">¶</a>动态嵌入式SQL（ESQL）</h2>
<p>包括动态组装SQL语句和动态参数两种形式</p>
<h3 id="使用SQL语句主变量"><a class="header-anchor" href="#使用SQL语句主变量">¶</a>使用SQL语句主变量</h3>
<p>程序主变量：就是输入输出主变量那些<br>
SQL语句主变量：内容是一句SQL语句</p>
<p>使用方法：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL BEGIN DECLARE SECTION;</span><br><span class="line">	const char *stmt="SQL语句;";		/*SQL语句主变量，注意有两个分号*/</span><br><span class="line">EXEC SQL END DECLARE SECTION;</span><br><span class="line"></span><br><span class="line">EXEC SQL EXECUTE IMMEDIATE :stmt;</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="动态参数"><a class="header-anchor" href="#动态参数">¶</a>动态参数</h3>
<ul>
<li>第一步：声明SQL语句主变量</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL BEGIN DECLARE SECTION;</span><br><span class="line">	const char *stmt="SQL语句;";		/*SQL语句主变量，注意这里面不确定的参数用？代表*/</span><br><span class="line">EXEC SQL END DECLARE SECTION;</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>第二步：准备语句</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL PREPARE [语句名] FROM :[SQL语句主变量];</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>第三步：执行语句</li>
</ul>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC SQL EXECUTE [语句名] &lt;INTO 主变量表&gt;&lt;USING 主变量或常量&gt;;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="存储过程"><a class="header-anchor" href="#存储过程">¶</a>存储过程</h2>
<p>PL/SQL语言：是SQL的过程化扩展，是编写数据库存储过程的一种过程语言</p>
<h3 id="PL-SQL的块结构"><a class="header-anchor" href="#PL-SQL的块结构">¶</a>PL/SQL的块结构</h3>
<p>PL/SQL程序的基本结构是块<br>
分为匿名块和命名块<br>
这里是匿名的，存储过程和函数是命名块</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/*定义部分*/</span><br><span class="line">DECLARE</span><br><span class="line">变量、常量、游标、异常etc</span><br><span class="line"></span><br><span class="line">/*执行部分*/</span><br><span class="line">BEGIN</span><br><span class="line">语句</span><br><span class="line">EXCEPTION</span><br><span class="line">异常处理</span><br><span class="line">END;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="变量常量的定义"><a class="header-anchor" href="#变量常量的定义">¶</a>变量常量的定义</h3>
<p><em>注：方括号内的内容表示可选</em><br>
变量：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名 数据类型 [[NOT NULL]:=初值表达式];</span><br></pre></td></tr></tbody></table></figure>
<p>常量：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">常量名 数据类型 CONSTANT:=常量表达式;</span><br></pre></td></tr></tbody></table></figure>
<p>赋值：</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量名称:=表达式;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="控制结构"><a class="header-anchor" href="#控制结构">¶</a>控制结构</h3>
<h4 id="条件控制语句"><a class="header-anchor" href="#条件控制语句">¶</a>条件控制语句</h4>
<p>第一种</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">IF condition THEN</span><br><span class="line">	语句;</span><br><span class="line">END IF</span><br></pre></td></tr></tbody></table></figure>
<p>第二种</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IF condition THEN</span><br><span class="line">	语句;</span><br><span class="line">ELSE</span><br><span class="line">	语句;</span><br><span class="line">END IF</span><br></pre></td></tr></tbody></table></figure>
<p>第三种:THEN和ELSE里面可以再嵌套IF语句</p>
<h4 id="循环控制语句"><a class="header-anchor" href="#循环控制语句">¶</a>循环控制语句</h4>
<p>第一种</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">LOOP</span><br><span class="line">	语句；</span><br><span class="line">END LOOP;</span><br></pre></td></tr></tbody></table></figure>
<p>第二种</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">WHILE condition LOOP</span><br><span class="line">	语句；</span><br><span class="line">END LOOP;</span><br></pre></td></tr></tbody></table></figure>
<p>第三种</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">FOR count IN [REVERSE] bound1,...,bound2 LOOP</span><br><span class="line">	语句；</span><br><span class="line">END LOOP;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="存储过程-v2"><a class="header-anchor" href="#存储过程-v2">¶</a>存储过程</h3>
<h4 id="创建存储过程"><a class="header-anchor" href="#创建存储过程">¶</a>创建存储过程</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CREATE Procedure 过程名([参数1 数据类型，参数2 数据类型，...])	/*存储过程首部*/</span><br><span class="line">AS</span><br><span class="line">&lt;PL/SQL块&gt;;									/*存储过程体*/</span><br></pre></td></tr></tbody></table></figure>
<h4 id="重命名存储过程"><a class="header-anchor" href="#重命名存储过程">¶</a>重命名存储过程</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER Procedure 旧过程名 RENAME TO 新过程名;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="执行存储过程"><a class="header-anchor" href="#执行存储过程">¶</a>执行存储过程</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CALL/PERFORM Procedure 过程名([参数1，参数2，...]);</span><br></pre></td></tr></tbody></table></figure>
<h4 id="删除存储过程"><a class="header-anchor" href="#删除存储过程">¶</a>删除存储过程</h4>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP Procedure 过程名();</span><br></pre></td></tr></tbody></table></figure>
<h3 id="游标-v2"><a class="header-anchor" href="#游标-v2">¶</a>游标</h3>
<p>PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标PL/SQL中也可以用游标</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/05/How-to-do-E-R-Design/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/05/How-to-do-E-R-Design/" class="post-title-link" itemprop="url">How to do E-R Design</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-05 20:23:55" itemprop="dateCreated datePublished" datetime="2020-09-05T20:23:55+08:00">2020-09-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-12-28 10:30:13" itemprop="dateModified" datetime="2020-12-28T10:30:13+08:00">2020-12-28</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="区分实体和属性"><a class="header-anchor" href="#区分实体和属性">¶</a>区分实体和属性</h2>
<h3 id="什么能叫属性？"><a class="header-anchor" href="#什么能叫属性？">¶</a>什么能叫属性？</h3>
<p>两条准则：<br>
<img src="%5CHow-to-do-E-R-Design%5Catt.png" alt=""></p>
<p><img src="%5CHow-to-do-E-R-Design%5Cexample.png" alt=""></p>
<h3 id="数据库设计过程"><a class="header-anchor" href="#数据库设计过程">¶</a>数据库设计过程</h3>
<h4 id="从数据流图到E-R图（概念模型）"><a class="header-anchor" href="#从数据流图到E-R图（概念模型）">¶</a>从数据流图到E-R图（概念模型）</h4>
<ul>
<li>
<p>第一步：最开始我们有的是一个系统图，表示各个子系统之间的关系（子系统在这里也可以叫“局部应用”），例如这种：<br>
<img src="%5CHow-to-do-E-R-Design%5Csystem.png" alt=""></p>
</li>
<li>
<p>第二步：开一个循环（？）遍历所有子系统（局部应用），为每一个设计一个E-R图。</p>
</li>
<li>
<p>第三步：针对一个子系统我们怎么设计它的E-R图呢？</p>
<ol>
<li>首先从该子系统的数据流图找到设计E-R图的灵感<br>
<strong>第一层数据流图</strong>（整个子系统的）：<br>
<img src="%5CHow-to-do-E-R-Design%5Cfirst.png" alt=""><br>
<strong>第二层数据流图</strong>（再将这个子系统细分为几个）：这里分别是接受订单、处理订单、开发票、支付过账四个<br>
<img src="%5CHow-to-do-E-R-Design%5C1.png" alt=""><br>
<img src="%5CHow-to-do-E-R-Design%5C2.png" alt=""><br>
<img src="%5CHow-to-do-E-R-Design%5C3.png" alt=""><br>
<img src="%5CHow-to-do-E-R-Design%5C4.png" alt=""></li>
<li>根据这些数据流图，我们可以搭一个E-R图框架<br>
<img src="%5CHow-to-do-E-R-Design%5Cframe.png" alt=""></li>
<li>现在我们可以划分关系+定义属性了<br>
说得明白点，其实一个关系的名字应该就对应一个实体型，关系里的属性就对应实体型的属性。得到这样的结果：<br>
<img src="%5CHow-to-do-E-R-Design%5Centity.png" alt=""></li>
<li>根据语义，确定实体型之间的关系（1：1/1:n/m:n）</li>
<li>最后就可以画E-R图啦！<br>
完整版本应该是带属性的<br>
<img src="%5CHow-to-do-E-R-Design%5CER.png" alt=""></li>
</ol>
</li>
<li>
<p>第四步：当我们把每个子系统的E-R图设计好，就可以开始合并了！</p>
<ol>
<li>合并有两种方法，一种一步到位，另一种两两合并到最后（后一种方便些）——其实核心问题都集中在合并两个E-R图的时候怎么操作了</li>
<li>合并两个E-R图需要两步工作：<br>
（1）解决E-R图之间的冲突+合并为初步E-R图</li>
</ol>
<blockquote>
<p>冲突类型及解决方法详见Mindmap</p>
</blockquote>
<p>（2）消除冗余+生成基本E-R图</p>
<blockquote>
<p>消除冗余见Mindmap</p>
</blockquote>
</li>
</ul>
<h4 id="例子"><a class="header-anchor" href="#例子">¶</a>例子</h4>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/csdn_blog_lcl/article/details/78609119">一个完整的E-R模型设计过程</a><br>
有一说一……感觉这个比书上的好懂door了！！！</p>
<h4 id="从E-R图（概念模型）到关系模型（逻辑模型）"><a class="header-anchor" href="#从E-R图（概念模型）到关系模型（逻辑模型）">¶</a>从E-R图（概念模型）到关系模型（逻辑模型）</h4>
<p>对于实体型：一个实体型——一个关系模式，属性就是属性，码就是码</p>
<p>对于联系：<br>
1:1的关系<br>
（1）成为独立的关系模式：U=与联系相连的各实体的码+联系本身属性；候选码=各实体的码<br>
（2）与任意一端合并：被合并的那个加入另一端的码和联系的属性</p>
<p>1:n关系：<br>
（1）成为独立的关系模式：U=与联系相连的各实体的码+联系本身属性；候选码=n端实体的码<br>
（2）与n端合并</p>
<p>m:n关系与多元联系：<br>
（1）成为独立的关系模式：U=与联系相连的各实体的码+联系本身属性；各实体的码为关系的码的子集</p>
<p>注：相同码的关系模式可以合并</p>
<h3 id="E-R图设计的一些练习题"><a class="header-anchor" href="#E-R图设计的一些练习题">¶</a>E-R图设计的一些练习题</h3>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/zxq1138634642/article/details/9121363">一些练习题</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/09/04/Skills-for-Database-Exercises/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="CrestinyCoco">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Crestiny's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/09/04/Skills-for-Database-Exercises/" class="post-title-link" itemprop="url">Skills for Database Exercises</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-09-04 13:02:29" itemprop="dateCreated datePublished" datetime="2020-09-04T13:02:29+08:00">2020-09-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-09-07 09:48:51" itemprop="dateModified" datetime="2020-09-07T09:48:51+08:00">2020-09-07</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Courses/" itemprop="url" rel="index"><span itemprop="name">Courses</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <center><h1>如何求最小函数依赖集</h1></center>
<h2>教科书式的定理</h2>
![](\Skills-for-Database-Exercises\min.png)
<h2>说人话</h2>
- 第一步：看到函数依赖式右边有多个属性的，用分解规则拆开
- 第二步：考察F中的每个函数依赖，对于其中一个，令一个新的函数依赖集G，这个G就是在F中把这个函数依赖去掉所形成的。接下来，对于这个函数依赖的左边X，考察它在G上的闭包是什么，如果这个闭包包含了函数依赖的右边Y，那么就从F中去掉这个函数依赖；反之保留
- 第三步：对于F中每一个左端包含多个属性的函数依赖式，选择左边X的每个子集Z,如果右边Y属于Z的在F上的闭包,则用Z->Y代替X->Y
<h2>练练手</h2>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">关系模式R(U，F)中，U&#x3D;ABCDEG，F&#x3D;&#123;B-&gt;D，DG-&gt;C,BD-&gt;E,AG-&gt;B,ADG-&gt;BC&#125;，求F的最小函数依赖集</span><br></pre></td></tr></table></figure>
- 第一步：用分解规则拆右边，得到新的F={B->D，DG->C,BD->E,AG->B,ADG->B,ADG->C}
- 第二步：
对于B->D，B在G中的闭包是{B},不包含D，所以可以保留
对于DG->C，DG在G中的闭包是{D，G}，不包含C，所以可以保留
对于BD->E，BD在G中的闭包是{B，D}，不包含E，所以可以保留
对于AG->B，AG在G中的闭包是{A，G}，不包含B，所以可以保留
对于ADG->B，ADG在G中的闭包是{A，D，G，B，C，E}，包含B，所以丢弃
对于ADG->C，ADG在G中的闭包是{A，D，G，B，C，E}，包含C，所以丢弃
*注：这里每一步考察完，到下一步时用的还是原来那个F，一次考察就是一次考察，不会动态变化的，不然就很奇怪了。*
好，现在的F={B->D，DG->C,BD->E,AG->B}
- 第三步：
对于DG->C，D在F上的闭包是{D}，没啥替换的；G在F上的闭包是{G}，同样没啥
对于BD->E，B在F上的闭包是{B，D，E}，包含E，可用B->E替换BD->E
对于AG->B，A在F上的闭包是{A}....
所以现在的F={B->D，DG->C,B->E,AG->B}
<center><h1>如何求一个属性(组)在某函数依赖集上的闭包</h1></center>
<h2>教科书式的定理</h2>
![](\Skills-for-Database-Exercises\algorithm.png)
<h2>说人话</h2>
通过一个多次迭代的方法求。
![](\Skills-for-Database-Exercises\algorithm1.png)
*注：改正一下，应该是“在F中找到一些函数依赖式——它们的左边应该是**包含于**X(i)的”*
<center><h1>如何求某函数依赖集的闭包</h1></center>
其实就是用那些公理、推理规则之类的开始造作！
**如何不重不漏？**
这好像是个NP问题啊....
<center><h1>如何判断一个函数依赖FD是否属于某函数依赖集F的闭包</h1></center>
用公理+推理规则，能推导出来就是属于
<center><h1>如何设计E-R图并转换</h1></center>
<center><h1>如何写好SQL查询</h1></center>
<center><h1>如何判断关系所属范式</h1></center>
我觉得在实际判断中，下面这些判断方法应该一个个往后用，就像过五关斩六将一样
<h2>准备工作</h2>
- 第一步：找出数据表中所有的候选码。
首先考察包含一个属性的所有属性组，看它们能否唯一确定别的所有属性；接下来看包含两个属性的、三个的...以此类推
*Tips:假如A是码，那么所有包含了A的属性组，如（A，B）、（A，C）、（A，B，C）等等，都不是候选码了（因为作为码的要求里有一个“完全函数依赖”）*
- 第二步：根据第一步所得到的候选码，找出所有的主属性。
也就是其中用到的所有属性（候选码的并集）
- 第三步：数据表中，除去所有的主属性，剩下的就都是非主属性了。
<h2>判断是否为2NF</h2>
**在关系模式中若没有非主属性对码的部分函数依赖即可称为2NF**
<pre>考虑关系模式R（A,B,C,D），已知函数依赖有{B->D,AB->C}，关系模式R的码是（    ），R属于（    ）范式
首先找码 码是AB，然后又有D依赖于B，而B属于AB，所以存在D部分函数依赖于AB，所以不是第二范式</pre>
<h2>判断是否为3NF</h2>
**在关系模式中若没有非主属性对码的传递函数依赖即可称为3NF**
<h2>判断是否为BCNF</h2>
**在关系模式中，如果每一个决定因素都包含码，则属于BCNF**
<h2>判断是否为4NF</h2>
<center><h1>如何将关系规范化（各种模式分解算法）</h1></center>
<center><h1>SQL语句转查询树</h1></center>
给个例子你就懂了，叶子应该是关系。
原SQL语句：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT Sname</span><br><span class="line">FROM Student，SC</span><br><span class="line">WHERE Student.Sno&#x3D;SC.Sno AND SC.Cno&#x3D;&#39;2&#39;;</span><br></pre></td></tr></table></figure>
优化后：
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT Sname</span><br><span class="line">FROM Student</span><br><span class="line">WHERE Student.Sno in (</span><br><span class="line">	SELECT Sno</span><br><span class="line">	FROM SC</span><br><span class="line">	WHERE SC.Cno&#x3D;&#39;2&#39;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
![](\Skills-for-Database-Exercises\tree.png)
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">CrestinyCoco</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">83</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">CrestinyCoco</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/pjax/pjax.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>

  <script>
var pjax = new Pjax({
  selectors: [
    'head title',
    '#page-configurations',
    '.content-wrap',
    '.post-toc-wrap',
    '.languages',
    '#pjax'
  ],
  switches: {
    '.post-toc-wrap': Pjax.switches.innerHTML
  },
  analytics: false,
  cacheBust: false,
  scrollTo : !CONFIG.bookmark.enable
});

window.addEventListener('pjax:success', () => {
  document.querySelectorAll('script[data-pjax], script#page-configurations, #pjax script').forEach(element => {
    var code = element.text || element.textContent || element.innerHTML || '';
    var parent = element.parentNode;
    parent.removeChild(element);
    var script = document.createElement('script');
    if (element.id) {
      script.id = element.id;
    }
    if (element.className) {
      script.className = element.className;
    }
    if (element.type) {
      script.type = element.type;
    }
    if (element.src) {
      script.src = element.src;
      // Force synchronous loading of peripheral JS.
      script.async = false;
    }
    if (element.dataset.pjax !== undefined) {
      script.dataset.pjax = '';
    }
    if (code !== '') {
      script.appendChild(document.createTextNode(code));
    }
    parent.appendChild(script);
  });
  NexT.boot.refresh();
  // Define Motion Sequence & Bootstrap Motion.
  if (CONFIG.motion.enable) {
    NexT.motion.integrator
      .init()
      .add(NexT.motion.middleWares.subMenu)
      .add(NexT.motion.middleWares.postList)
      .bootstrap();
  }
  NexT.utils.updateSidebarPosition();
});
</script>




  















    <div id="pjax">
  

  

  

    </div>
  
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/miku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"react":{"opacity":0.7},"log":false});</script></body>
</html>
